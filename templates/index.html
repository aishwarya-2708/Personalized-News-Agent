
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Personalized News Agent</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 30px; transition: background 0.3s, color 0.3s;}
        h1 { text-align: center; color: #0d6efd; margin-bottom: 30px; }
        .card { margin-bottom: 25px; transition: transform 0.2s, box-shadow 0.2s; }
        .card:hover { transform: scale(1.02); box-shadow: 0 6px 15px rgba(0,0,0,0.2);}
        .card-title { color: #0d6efd; }
        .btn-outline-primary { border-radius: 50px; padding: 5px 20px; font-weight: bold; }
        .bullet-point { font-size: 0.95rem; }
        footer { text-align: center; margin-top: 50px; color: #6c757d; }
        .dark-mode { background: #121212; color: #e0e0e0; }
        .dark-mode .card { background: #1e1e1e; color: #e0e0e0; }
        .dark-mode .btn-outline-primary { color: #0d6efd; border-color: #0d6efd; }
        #loading { display: none; text-align: center; margin: 20px 0; }
    </style>
</head>
<body>

<h1><i class="fa-solid fa-newspaper"></i> Personalized News Agent</h1>

<div class="d-flex justify-content-center mb-3 gap-2 flex-wrap">
    <input type="text" id="topic" class="form-control" placeholder="Enter topic" style="max-width:300px;">
    <select id="language" class="form-select" style="max-width:150px;">
        <option value="en">English</option>
        <option value="hi">Hindi</option>
        <option value="mr">Marathi</option>
    </select>
    <button class="btn btn-primary" onclick="getNews()"><i class="fa-solid fa-magnifying-glass"></i> Get News</button>
    <button class="btn btn-secondary" onclick="toggleDarkMode()"><i class="fa-solid fa-moon"></i> Dark Mode</button>
</div>

<div id="loading"><i class="fa-solid fa-spinner fa-spin fa-2x"></i> Loading...</div>
<div id="results" class="container"></div>

<footer>
    <p>Developed by Aishwarya Patil</p>
</footer>

<script>
let darkMode = false;

function toggleDarkMode() {
    darkMode = !darkMode;
    document.body.classList.toggle("dark-mode", darkMode);
}

async function getNews() {
    const topic = document.getElementById("topic").value.trim();
    const language = document.getElementById("language").value;
    if (!topic) return alert("Please enter a topic!");

    const resultsDiv = document.getElementById("results");
    const loadingDiv = document.getElementById("loading");
    resultsDiv.innerHTML = "";
    loadingDiv.style.display = "block";

    try {
        const response = await fetch("/get_news", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ topic, language })
        });
        const data = await response.json();
        loadingDiv.style.display = "none";

        if(data.length === 0) {
            resultsDiv.innerHTML = "<p class='text-center'>No news found for this topic.</p>";
            return;
        }

        data.forEach(article => {
            const div = document.createElement("div");
            div.classList.add("card");
            div.innerHTML = `
                <div class="card-body">
                    <h5 class="card-title"><i class="fa-solid fa-newspaper"></i> ${article.title}</h5>
                    <ul class="card-text">
    ${article.summary.map(point => `<li class="bullet-point">${point}</li>`).join('')}
</ul>

                    <button class="btn btn-outline-primary mb-2" onclick="copySummary(this)">
                        <i class="fa-solid fa-copy"></i> Copy Summary
                    </button>
                    <a href="${article.url}" target="_blank" class="btn btn-outline-primary">
                        <i class="fa-solid fa-arrow-up-right-from-square"></i> Read More
                    </a>
                </div>
            `;
            resultsDiv.appendChild(div);
        });

    } catch (error) {
        loadingDiv.style.display = "none";
        resultsDiv.innerHTML = `<p class='text-center text-danger'>Error fetching news. Try again.</p>`;
    }
}

// Copy summary to clipboard
function copySummary(button) {
    const summary = Array.from(button.parentElement.querySelectorAll("li"))
                         .map(li => li.innerText)
                         .join("\n");
    navigator.clipboard.writeText(summary).then(() => {
        alert("Summary copied to clipboard!");
    });
}
</script>

</body>
</html>
